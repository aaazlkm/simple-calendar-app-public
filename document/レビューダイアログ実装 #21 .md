# レビューダイアログ実装 #21

- todo
  - [x] 命名いいのがないか
  - [x] domain
  - [x] レビューダイアログ の条件に拒否った回数もいれる
  - [x] infra
  - [x] ダイアログ準備
  - [x] 契機準備
  - [x] ダイアログ表示
  - [x] 動作確認
  - [x] viewModel改善方法

## viewModel改善方法

- やりたいこと
  - ViewModeの操作をViewに露出したくない
  - ViewModelのプロパティだけを公開するようにしたい
  - ViewModel.ofでアクセスするようにしたい
- これまでの問題点
  - ofを使ってるのに違う方のクラスを返しているのがうざい
- 改善方法
  - 1 プロパティの部分はmixinでViewModelと命名して定義する
    - メソッド部分をViewModelではない命名にする
      - これが決まれば改善できる
      - 案
        - Controller?
          - ViewControolerとかぶるので嫌だな
        - Body
          - なんのことなのか分かりづらい
  - 2 プロパティ部分を違う命名にする
    - Dataなど
    - 理由
      - ViewModelの処理部分の命名を変えようとしたが、適切なものが浮かばない
        - ViewModelという言葉が意味として処理のことまで内包してしまっているから
        - Viewmodel + someで命名しようにも頭痛が痛い見たな意味がかぶる感じでしか命名することができない
        - そんなこと言ったら、DataだってViewModelに内包されているか
        - ここでの問題は単純にメソッド部分を切り出すための美味い命名が思いつかないこと
          - それよりも、Dataで取り出した方が分かりやすく感じる
      - なので、Data部分の命名を変えるがいいきがうる
        - ViewModelDataみたいな
        - アクセスする時もViewModelDataにアクセスする
          - これでViewModel.ofの問題もなくなる
      - デメリットとしては、
        - View側がViewModelではなくViewModelDataからアクセスする必要があることを認識する必要があること
          - 通常ViewModelからアクセスしようとするのが直感的に感じる
- 結論
  - ViewModelDataにする
    - ViewModelのmethod部分を切り出したクラスのいい命名が思いつかなかった
      - 思いついてControllerやBodyだったが、適していないように感じる
    - 一方でViewModelのdata部分を、ViewModelDataで切り出すのは妥当に感じる
      - なので、ViewModelDataにする
      - これの欠点
        - View側がViewModelからデータを取得するのではなく、ViewModelDataからデータを取得することを知らないといけない
          - 直感的にはViewModelからデータを取得できるイメージがある
          - まあ、データ部分にアクセスしてることを明示的にできるのでそんなにデメリットにもなっていない気がする
  - ViewModelのメソッド切り出し部分のいい命名が思いついたら、変更する

## 動作確認

- [x] 一度ストアに遷移したら、ダイアログが表示されなくなるか
- [x] イベントサイズが5以下の時は表示されないか
- [x] 時間を置かないとダイアログは表示されないか
- [x] ダイアログを3回表示すると、それ以降表示されなくなるか

## 命名いいのがないか

- 機能  
  - ユーザに何かしらのメッセージを表示する契機をまとめる
    - 景気には条件が存在する
  - アプリからユーザに対して伝えたいことを伝える条件をまとめる
  - アプリのイベントの発生条件についてまとめる
  - 具体例
    - 他のアプリおすすめ
    - 新しくサブスクが登場した
    - レビューダイアログを表示
- 案
  - 1 app_event
    - アプリ内のイベントについてまとめたものなので、妥当な感じがする
    - が、発生条件についてまとめるので、termsをつけた方がいい？
      - 条件以外にもApp_eventにまつわる、recordなどの処理も入れることになる(ダイアログを一度表示したことを記録するなど)
      - なので、terms入れると命名が狭い感じがする
  - 2 ~~message trigger~~
    - 3と同じ
  - 3 ~~event trigger~~
    - triggerだと、イベントを発生させる感じになる
    - 今回は、イベントの条件のみをまとめるクラス
  - 4 ~~app message~~
    - 別にメッセージについては管理しない
    - メッセージを表示する条件について管理する
  - 5 ~~event~~
    - calendarのイベントと命名がかぶるからダメだな
- 結論
  - app_eventにする
  - ただ違和感がるので、もっといい名前が思いついたらそれにする
